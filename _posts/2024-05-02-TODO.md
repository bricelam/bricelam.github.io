---
layout: post
title: System Tray .NET Worker Services
tags: miscellaneous
---

https://github.com/alex-oswald/WindowsFormsLifetime/pull/24/files


Sometimes, you need to write code that runs in the background. There are a couple of well-documented ways to this this. The first is as a [Console App](https://learn.microsoft.com/dotnet/core/extensions/workers) that runs worker services as the user and logs events to the console. The second is as a [Windows Service](https://learn.microsoft.com/dotnet/core/extensions/windows-service) that runs in the background under a service account and logs events to Event Viewer. But what if you want something that runs in the background as the user? In this post, we'll create a worker service that runs in the user's System Tray.

Creating a System Tray app has a few advantages over the other two approaches. Unlike a console app, the user interface is much friendlier for everyday users. And unlike a Windows service, workers can run as the current user to perform actions on their behalf.

Let's use the Console app code as our starting point. Create a new project using the `worker` project template.

```console
dotnet new worker
```

The first thing we need to do is update it to use Windows Forms. Manually edit the project file to look like the following.

```xml
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <OutputType>WinExe</OutputType>
    <TargetFramework>net7.0-windows</TargetFramework>
    <Nullable>enable</Nullable>
    <UseWindowsForms>true</UseWindowsForms>
    <ImplicitUsings>enable</ImplicitUsings>
    <RollForward>major</RollForward>
    <ApplicationIcon>Resources\Icon.ico</ApplicationIcon>
  </PropertyGroup>
```
